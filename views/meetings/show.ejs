<%- include('../partials/header') %>

<a href="/meetings">Back to meetings</a>
<section id="meeting-info">
    <div>Meeting:</div>
    <div><%= meetings.mtgName %></div>
    
    <div>Organization:</div>
    <div><%= meetings.organization %></div>
    
    <div>Weekday:</div>
    <div><%= meetings.weekday %></div>

    <div>Time:</div>
    <div><%= meetings.time %></div>
    
    <div>Length:</div>
    <div><%= meetings.length %>h</div>
    
    <div>Format:</div>
    <div id="mtg-format"><%= meetings.format %></div>

    <div>Location:</div>
    <div id="meeting-location"><%= meetings.address %></div>
    
    <div id="zoom-info">
        <div>URL:</div>
        <div><a href="<%= meetings.link %>">Zoom Link</a></div>

        <div>Meeting ID:</div>
        <div><%= meetings.mtgId %></div>

        <div>Meeting Passcode:</div>
        <div><%= meetings.mtgPasscode %></div>
    </div>

    <% if (currentUser && meetings && currentUser._id.toString() === meetings.userMtg.toString()) { %>
    <a href="/meetings/<%= meetings._id %>/edit"><button id="update-meeting-btn">Update Meeting</button></a>
    <form id="remove-mtg-form" action="/meetings/<%= meetings._id %>?_method=DELETE" method="POST">
        <button id="remove-mtg-btn" type="submit">Remove Meeting</button>
    </form>
 
</section>

<section>
   
    <form id="comment-form" method="POST" action="/meetings/<%= meetings._id %>/comments">
        <label>Comment:</label>
        <textarea name="content"></textarea> 
        <input type="submit" value="Comment">
    </form>
    <% } %>
</section>
<section>
    <% if (meetings.comments.length) { %>
        <div>Comments:</div>
        <% meetings.comments.forEach(c => { %>
            <div>Comment Date: <%= c.createdAt.toLocaleDateString() %></div>
            <div><img alt="User Avatar" src="<%= c.avatar %>"></div>
            <div><%= c.name %></div>
            <div><%= c.content %></div>
            <div>
                <% if (user?._id.equals(c.user)) { %>
                    <form action="/comments/<%= c._id %>?_method=DELETE" method="POST">
                        <button id="delete-comment" type="submit">X</button>
                    </form>
                <% } %>    
            </div>
         <% }) %>
     <% } else { %>
        <h5>Be the first to comment!</h5>
        <% } %>
</section>

<%- include('../partials/footer') %>